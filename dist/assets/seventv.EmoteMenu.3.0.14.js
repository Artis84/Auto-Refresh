import{_ as z,l as r,f as a,j as c,i as ce,p as de,e as H,C as re,G as B,a as W,w as ie,W as ve,o as me,s as S,B as U,F as I,m as N,aO as fe,u as k,at as pe,L as _e,aD as he,aG as ge,A as be,k as P,q as X,x as ee,I as te,aF as Ce,aI as Ee,av as ye}from"./seventv.index.3.0.14.js";import{a as we,f as ke,g as Oe,h as Ie,u as Te,o as Se}from"./seventv.index.3.0.143.js";import{u as ae}from"./seventv.main.3.0.14.js";import{u as le}from"./seventv.useChannelContext.3.0.14.js";import{_ as K,c as Ae,a as Me,G as $e,b as xe}from"./seventv.StoreSubscribeButton.3.0.14.js";import{a as j,r as T,t as J,u as f}from"./seventv.useUserAgent.3.0.14.js";import{d as ue}from"./seventv.ReactHooks.3.0.14.js";import{u as Fe}from"./seventv.useChatEmotes.3.0.14.js";import{D as Ve,u as Le,a as Pe}from"./seventv.Settings.3.0.14.js";import{C as Re,u as De}from"./seventv.CloseIcon.3.0.14.js";import{u as Be}from"./seventv.useUpdater.3.0.14.js";import{E as Ue,_ as je}from"./seventv.Emote.3.0.14.js";import{d as oe}from"./seventv.Transform.3.0.14.js";import{U as Ne}from"./seventv.UiFloating.3.0.14.js";const Ge={},Ke={width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Je=c("path",{d:"M11.3733 5.68667C11.3733 6.94156 10.966 8.10077 10.2797 9.04125L13.741 12.5052C14.0827 12.8469 14.0827 13.4019 13.741 13.7437C13.3992 14.0854 12.8442 14.0854 12.5025 13.7437L9.04125 10.2797C8.10077 10.9687 6.94156 11.3733 5.68667 11.3733C2.54533 11.3733 0 8.828 0 5.68667C0 2.54533 2.54533 0 5.68667 0C8.828 0 11.3733 2.54533 11.3733 5.68667ZM5.68667 9.62359C7.86018 9.62359 9.62359 7.86018 9.62359 5.68667C9.62359 3.51316 7.86018 1.74974 5.68667 1.74974C3.51316 1.74974 1.74974 3.51316 1.74974 5.68667C1.74974 7.86018 3.51316 9.62359 5.68667 9.62359Z",fill:"currentColor"},null,-1),ze=[Je];function Ze(v,m){return r(),a("svg",Ke,ze)}const qe=z(Ge,[["render",Ze]]),se=Symbol("seventv-emote-menu-context");function Q(){let v=ce(se,null);return v||(v=j({open:!1,filter:"",channelID:""}),de(se,v)),v}const We={mounted(v,m){const{value:p}=m;p("mounted",v)},updated(v,m){const{value:p}=m;p("updated",v)},beforeUnmount(v,m){const{value:p}=m;p("unmounted",v)}},Xe=["collapsed","ephemeral"],He={class:"seventv-set-header"},Qe={class:"seventv-set-header-icon"},Ye=["src"],et={class:"seventv-set-name"},tt={key:0,class:"seventv-emote-set"},ot=["disabled","ratio","load-state","set-id","emote-id","zero-width","favorite","onClick","onKeydown"],st=H({__name:"EmoteMenuSet",props:{es:{},ephemeral:{type:Boolean}},emits:["emote-clicked","emotes-updated"],setup(v,{expose:m,emit:p}){const l=v,{t:R,te:b}=re(),F=Q(),A=T([]),V=T(),O=T(!1),C=B("ui.emote_menu.collapsed_sets"),E=B("ui.emote_menu.favorites"),h=B("ui.emote_menu.usage"),{alt:y}=we(),M=T(n());function $(t){if(l.es.id==="USAGE"){const o=h.value.get(t.id)??0;return o-o*2||0}let e=oe(t);return(t.flags||0)!==0&&(e-=.5),e}const D=ue((t="")=>{const e=[];if(!(l.es.provider&&!l.es.emotes.length)){for(const o of l.es.emotes)t&&!o.name.toLowerCase().includes(t.toLowerCase())||e.push(o);e.sort((o,_)=>{const L=$(o),Y=$(_);return L==Y?o.name.localeCompare(_.name):L>Y?1:-1}),A.value=e,p("emotes-updated",e)}},25);function u(t,e){return t.scope==="PERSONAL"&&e.data&&e.data.state&&!e.data.state.includes("PERSONAL")}function d(t){if(!u(l.es,t)){if(y.value){E.value.has(t.id)?E.value.delete(t.id):E.value.add(t.id),E.value=new Set(E.value);return}p("emote-clicked",t)}}function g(){const t=`emote_menu.sets.${l.es.name}`;return b(t)?R(t):l.es.name}ke("Escape",()=>{F.open=!1}),W(()=>l.es.emotes,()=>{D(F.filter)}),ie(()=>{D(F.filter)});const s=j({}),w=T(!1),Z=l.es.provider!=="EMOJI";let x;function q(){x||(x=new IntersectionObserver(t=>{t.forEach(async e=>{const o=e.target.getAttribute("emote-id");if(e.isIntersecting&&!s[o]){const _=s[o]===-1;s[o]=0,Z&&!_&&w.value&&await _e(he(100)).toBeTruthy()}if(s[o]===0&&!e.isIntersecting){delete s[o];return}if(e.isIntersecting&&s[o]===0){s[o]=1;return}!e.isIntersecting&&s[o]>=0&&(s[o]=s[o]===1?-1:0)}),w.value=!0}),O.value=!0)}function G(t,e){if(x)for(let o=0;o<e.children.length;o++){const _=e.children.item(o);if(!_)continue;const L=_.getAttribute("emote-id");!L||s[L]||(t==="mounted"||t==="updated"?x.observe(_):x.unobserve(_))}}function n(){return C.value?C.value.has(l.es.id):!1}function i(){C.value&&(n()?(C.value.delete(l.es.id),M.value=!1):(C.value.add(l.es.id),M.value=!0),C.value=new Set(C.value))}return ve(()=>{q()}),me(()=>{x&&x.disconnect()}),m({containerEl:V}),(t,e)=>t.ephemeral||A.value.length?(r(),a("div",{key:0,ref_key:"containerEl",ref:V,class:"seventv-emote-set-container",collapsed:M.value,ephemeral:t.ephemeral},[c("div",He,[c("div",Qe,[t.es.owner&&t.es.owner.avatar_url?(r(),a("img",{key:0,src:t.es.owner.avatar_url},null,8,Ye)):(r(),S(K,{key:1,class:"logo",provider:t.es.provider},null,8,["provider"]))]),c("span",et,J(g()),1),c("div",{class:"seventv-set-chevron",onClick:i},[t.ephemeral?(r(),S(Re,{key:1})):(r(),S(Ve,{key:0}))])]),O.value?U((r(),a("div",tt,[(r(!0),a(I,null,N(A.value,o=>{var _;return r(),a("div",{key:o.id,class:"seventv-emote-container",disabled:u(t.es,o),ratio:f(oe)(o),"load-state":s[o.id],"set-id":t.es.id,"emote-id":o.id,"zero-width":(o.flags||0)!==0,favorite:((_=f(E))==null?void 0:_.has(o.id))&&t.es.id!=="FAVORITE",tabindex:"0",onClick:L=>d(o),onKeydown:fe(ge(L=>d(o),["prevent"]),["enter"])},[s[o.id]?(r(),S(Ue,{key:0,emote:o,unload:!s[o.id]},null,8,["emote","unload"])):k("",!0)],40,ot)}),128))])),[[f(We),G]]):k("",!0),pe(t.$slots,"default",{},void 0,!0)],8,Xe)):k("",!0)}});const ne=z(st,[["__scopeId","data-v-46bd2c2e"]]),nt={class:"seventv-emote-menu-tab-container"},rt={class:"seventv-promotion-personal-emotes"},it={class:"seventv-emote-menu-tab-sidebar"},at={class:"seventv-emote-menu-sidebar-icons"},lt=["selected","onClick"],ut={class:"seventv-emote-menu-set-sidebar-icon"},ct={key:0,class:"seventv-emote-menu-emoji-group"},dt=["src"],vt={class:"seventv-emote-menu-settings-button-container"},mt={key:0,class:"seventv-emote-menu-settings-button-update-flair"},ft=H({__name:"EmoteMenuTab",props:{provider:{},selected:{type:Boolean}},emits:["emote-clicked","provider-visible","toggle-settings","toggle-native-menu"],setup(v,{emit:m}){var G;const p=v,{t:l}=re(),R=Q(),b=le(R.channelID),F=Fe(b),A=Be(),V=T(""),O=F.byProvider(p.provider)??j({}),C=ae(),E=De(((G=C.identity)==null?void 0:G.id)??""),h=Le(),y=j(new Set),M=T([]),$=B("ui.emote_menu.favorites"),D=["1f603","1f44b","1f343","1f354","26bd","1f698","1f4a1","1f523","1f6a9"],u=["Smileys & Emotion","People & Body","Animals & Nature","Food & Drink","Activities","Travel & Places","Objects","Symbols","Flags"],d={id:"personal-ad",name:"Personal Emotes",emotes:[]};function g(){return $.value?Array.from($.value.values()).map(n=>F.find(i=>i.id===n)).filter(n=>!!n):[]}if(p.provider==="FAVORITE"){const n=O.FAVORITE=j({id:"FAVORITE",name:l("emote_menu.favorite_set"),emotes:g()});W($,()=>{n.emotes=g()})}function s(n,i){if(!i||!i.length)return;const t=i[0];t.containerEl&&(V.value=n,t.containerEl.scrollIntoView({behavior:"auto"}))}function w(n){return n.scope==="GLOBAL"?1:b.id&&n.owner&&n.owner.id===b.id?-1:(n.flags??0)&4?-2:0}function Z(n,i){const t=w(n),e=w(i);return n.provider==="EMOJI"&&i.provider==="EMOJI"&&u.indexOf(n.name)>-1&&u.indexOf(i.name)>-1?u.indexOf(n.name)-u.indexOf(i.name):t==e?n.name.localeCompare(i.name):t>e?1:-1}function x(n,i){i?y.add(n.id):y.delete(n.id),m("provider-visible",!!y.size)}const q=ue(()=>{var i;const n=Object.values(O);if((i=E.emoteSets)!=null&&i.size&&n.push(...Array.from(E.emoteSets.values()).filter(t=>t.provider===p.provider)),p.provider==="PLATFORM"){const t=n.reduce((e,o)=>{const _=e[o.name];return _?_.emotes.push(...o.emotes):e[o.name]={set:o,emotes:[...o.emotes]},e},{});n.splice(0,n.length,...Object.values(t).map(e=>({...e.set,emotes:e.emotes})))}n.sort(Z),M.value=n},50);return W(()=>[R.filter,O,E.emoteSets],q,{immediate:!0}),(n,i)=>{const t=be("t");return r(),a("div",nt,[P(Me,null,{default:X(()=>[n.provider==="PLATFORM"?(r(),a("div",{key:0,class:"seventv-native-menu-toggle",onClick:i[0]||(i[0]=e=>m("toggle-native-menu"))},[P(K,{provider:"PLATFORM"}),U(c("span",null,null,512),[[t,"emote_menu.native"]])])):k("",!0),n.provider==="7TV"&&!f(h).sub?(r(),S(ne,{key:1,es:d,ephemeral:!0},{default:X(()=>[c("div",rt,[c("div",null,[U(c("p",null,null,512),[[t,"emote_menu.personal_emotes_promo_1"]]),c("span",null,J(f(l)("emote_menu.personal_emotes_promo_2",{PLATFORM:f(C).platform.charAt(0)+f(C).platform.slice(1).toLowerCase()})),1)]),P(Ae)])]),_:1})):k("",!0),(r(!0),a(I,null,N(M.value,e=>(r(),a(I,{key:e.id},[e.emotes.length?(r(),S(ne,{key:0,ref_for:!0,ref:"es-"+e.id,es:e,onEmoteClicked:i[1]||(i[1]=o=>m("emote-clicked",o)),onEmotesUpdated:o=>x(e,!!o.length)},null,8,["es","onEmotesUpdated"])):k("",!0)],64))),128))]),_:1}),c("div",it,[c("div",at,[(r(!0),a(I,null,N(M.value,e=>(r(),a(I,{key:e.id},[e.emotes.length?(r(),a("div",{key:0,class:"seventv-emote-menu-set-sidebar-icon-container",selected:V.value==e.id,onClick:o=>s(e.id,n.$refs["es-"+e.id])},[c("div",ut,[e.provider==="EMOJI"&&u.indexOf(e.name)>-1?(r(),a("div",ct,[P(je,{id:D[u.indexOf(e.name)],alt:e.name},null,8,["id","alt"])])):e.owner&&e.owner.avatar_url?(r(),a("img",{key:1,src:e.owner.avatar_url},null,8,dt)):(r(),S(K,{key:2,class:"logo",provider:e.provider},null,8,["provider"]))])],8,lt)):k("",!0)],64))),128))]),c("div",vt,[c("div",{class:"seventv-emote-menu-settings-button",onClick:i[2]||(i[2]=e=>m("toggle-settings"))},[P($e,{provider:"7TV"}),f(A).isUpToDate?k("",!0):(r(),a("div",mt))])])])])}}});const pt=z(ft,[["__scopeId","data-v-8f05a3ef"]]),_t={class:"seventv-emote-menu-header"},ht={class:"seventv-emote-menu-providers"},gt=["selected","onClick"],bt={key:0,class:"seventv-emote-menu-search"},Ct={class:"search-icon"},Et=H({__name:"EmoteMenu",props:{anchorEl:{},width:{},scale:{}},emits:["emote-click","toggle-native-menu","close"],setup(v,{emit:m}){const p=v,l=T(),R=le(),b=Q();b.channelID=R.id;const F=Pe(),{providers:A,platform:V}=ae(),O=T(),C=B("ui.emote_menu_search"),E=B("ui.emote_menu.default_tab","7TV"),h=T(E.value),y=j({FAVORITE:!0,"7TV":A.has("7TV"),FFZ:A.has("FFZ"),BTTV:A.has("BTTV"),PLATFORM:!0,EMOJI:!0});ie(()=>{l.value&&(l.value.style.setProperty("--width",p.width??"unset"),l.value.style.setProperty("--seventv-emote-menu-scale",p.scale??"3rem"),O.value&&O.value.focus())});const M=Oe("Control",{initial:!1});Ie("e",u=>{M.value&&($(),u.preventDefault())}),Te("keydown",u=>{if(!["ArrowUp","ArrowDown"].includes(u.key))return;const d=Object.keys(y).indexOf(h.value??"7TV"),g=u.key==="ArrowUp"?d+1:d-1,s=Object.keys(y)[g];s&&(h.value=s)});function $(){b.open=!b.open}function D(u,d){var g;y[u]=d,!d&&u===h.value&&(h.value=((g=Object.entries(y).slice(1).find(([,s])=>s))==null?void 0:g[0])??"7TV")}return Se(l,u=>{m("close",u)}),(u,d)=>(r(),S(Ne,{anchor:u.anchorEl,placement:"top-end",middleware:[f(Ee)({padding:4,mainAxis:!0,crossAxis:!0}),f(ye)({mainAxis:4,crossAxis:-4})]},{default:X(()=>[f(b).open&&f(b).channelID?(r(),a("div",{key:0,ref_key:"containerRef",ref:l,class:"seventv-emote-menu"},[c("div",_t,[c("div",ht,[(r(!0),a(I,null,N(y,(g,s)=>(r(),a(I,null,[g||s===h.value?(r(),a("div",{key:s,class:"seventv-emote-menu-provider-icon",selected:s===h.value,onClick:w=>h.value=s},[s!=="FAVORITE"?(r(),S(K,{key:0,provider:s},null,8,["provider"])):(r(),S(xe,{key:1})),U(c("span",null,[s==="PLATFORM"?(r(),a(I,{key:0},[ee(J(f(V)),1)],64)):(r(),a(I,{key:1},[ee(J(s),1)],64))],512),[[te,s===h.value]])],8,gt)):k("",!0)],64))),256))]),f(C)?k("",!0):(r(),a("div",bt,[U(c("input",{ref_key:"searchInputRef",ref:O,"onUpdate:modelValue":d[0]||(d[0]=g=>f(b).filter=g),class:"seventv-emote-menu-search-input",autofocus:""},null,512),[[Ce,f(b).filter]]),c("div",Ct,[P(qe)])]))]),(r(!0),a(I,null,N(y,(g,s)=>U((r(),a("div",{key:s,class:"seventv-emote-menu-body"},[P(pt,{provider:s,selected:s===h.value,onEmoteClicked:d[1]||(d[1]=w=>m("emote-click",w)),onProviderVisible:w=>D(s,w),onToggleSettings:d[2]||(d[2]=w=>f(F).toggle()),onToggleNativeMenu:d[3]||(d[3]=w=>[$(),m("toggle-native-menu")])},null,8,["provider","selected","onProviderVisible"])])),[[te,s===h.value]])),128))],512)):k("",!0)]),_:1},8,["anchor","middleware"]))}});const Pt=z(Et,[["__scopeId","data-v-23683dcf"]]);export{Pt as E,Q as u};
